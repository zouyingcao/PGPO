<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 29 May 2018 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_RB.css" rel="stylesheet" type="text/css" />
<title>3.1. Room Descriptions</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'Documentation/Images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'Documentation/Images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'Documentation/Images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'Documentation/Images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>
<p class="chapterheading">Chapter 3: Place</p>
<p class="chaptercontents"><a href="RB_3_1.html" class="standardlink"><span class="chaptercontentsitem">§3.1. Room Descriptions</span></a>; <a href="RB_3_2.html" class="standardlink"><span class="chaptercontentsitem">§3.2. Map</span></a>; <a href="RB_3_3.html" class="standardlink"><span class="chaptercontentsitem">§3.3. Position Within Rooms</span></a>; <a href="RB_3_4.html" class="standardlink"><span class="chaptercontentsitem">§3.4. Continuous Spaces and The Outdoors</span></a>; <a href="RB_3_5.html" class="standardlink"><span class="chaptercontentsitem">§3.5. Doors, Staircases, and Bridges</span></a>; <a href="RB_3_6.html" class="standardlink"><span class="chaptercontentsitem">§3.6. Windows</span></a>; <a href="RB_3_7.html" class="standardlink"><span class="chaptercontentsitem">§3.7. Lighting</span></a>; <a href="RB_3_8.html" class="standardlink"><span class="chaptercontentsitem">§3.8. Sounds</span></a>; <a href="RB_3_9.html" class="standardlink"><span class="chaptercontentsitem">§3.9. Passers-By, Weather and Astronomical Events</span></a></p><table class="centredtable"><tr><td class="roadsigndirection"><a href="RB_1_1.html" class="standardlink"><img alt="arrow-up-left.png" src="Documentation/Images/arrow-up-left.png" /></a></td><td><a href="RB_1_1.html" class="standardlink">Contents of <i>The Inform Recipe Book</i></a></td></tr>
<tr><td class="roadsigndirection"><a href="RB_2_1.html" class="standardlink"><img alt="arrow-left.png" src="Documentation/Images/arrow-left.png" /></a></td><td><a href="RB_2_1.html" class="standardlink">Chapter 2: Adaptive Prose</a></td></tr>
<tr><td class="roadsigndirection"><a href="RB_4_1.html" class="standardlink"><img alt="arrow-right.png" src="Documentation/Images/arrow-right.png" /></a></td><td><a href="RB_4_1.html" class="standardlink">Chapter 4: Time and Plot</a></td></tr>
<tr><td class="roadsigndirection"><a href="examples_alphabetical.html" class="standardlink"><img alt="arrow-down-right.png" src="Documentation/Images/arrow-down-right.png" /></a></td><td><a href="examples_alphabetical.html" class="standardlink">Indexes of the examples</a></td></tr>
</table><p class="sectionheading">§3.1. Room Descriptions</p>
<p>The printing of a room description is a more delicate business than it might initially seem to be: Inform has to consider all the objects that the player might have brought into the room or dropped there, and all the objects on visible supporters, and decide how to group and list them.</p>
<p>All of this behavior is handled by the looking command, so we find the relevant rules in the carry out looking rulebook. To go through the elements step by step:</p>
<p>Looking begins by printing the name and description of the room we're in. We can introduce variations into room names and descriptions by changing their printed name and description properties, as in</p>
<!-- START CODE "c23592" -->
<a id="c23592"></a><blockquote class="code"><p class="quoted">
now the printed name of the Church is &quot;Lightning-Struck Ruin&quot;;
<br />now the description of the Church is &quot;The beams overhead have been burnt away and the pews are charred. Only the stone walls remain.&quot;;
</p></blockquote>
<!-- END CODE -->
<p>If we need more drastic effects, we can turn off or change either of these features by altering the rules in the carry out looking rulebook. For instance, to remove the name of the location entirely from room descriptions, we would write</p>
<!-- START CODE "c23593" -->
<a id="c23593"></a><blockquote class="code"><p class="quoted">
The room description heading rule is not listed in the carry out looking rules.
</p></blockquote>
<!-- END CODE -->
<p>(A word of warning: there is one other context in which the story prints a room name — when restoring a save or undoing a move. To omit the room title here too, add</p>
<!-- START CODE "c23594" -->
<a id="c23594"></a><blockquote class="code"><p class="quoted">
Rule for printing the name of a room: do nothing.)
</p></blockquote>
<!-- END CODE -->
<p><span class="boldface">Ant-Sensitive Sunglasses</span> demonstrates how to use activities to make more flexible room description text.</p>
<p>Next, the story determines what items are visible to the player and need to be described. These never include the player himself, or scenery, but other things in the environment will be made &quot;marked for listing&quot;. This is also the stage at which Inform chooses the order in which items will be listed.</p>
<p>We are allowed to meddle by changing the priorities of objects, in case we want some things to be described to the player first or last in the room description; <span class="boldface">Priority Lab</span> goes into detail about how. We can also force things to be left out entirely: <span class="boldface">Low Light</span> handles the case of an object that can only be seen when an extra lamp is switched on, even though the room is not otherwise considered dark. <span class="boldface">Copper River</span> implements the idea of &quot;interesting&quot; and &quot;dull&quot; objects: the story determines which items are currently important to the puzzles or narrative and mentions those in the room description, while suppressing everything else.</p>
<p>Then Inform carries out the writing a paragraph about... activity with anything that provides one; anything it prints the name of, it tags &quot;mentioned&quot;. Thus</p>
<!-- START CODE "c23595" -->
<a id="c23595"></a><blockquote class="code"><p class="quoted">
Rule for writing a paragraph about Mr Wickham:
<br />&#160;&#160;&#160;&#160;say &quot;Mr Wickham looks speculatively at [list of women in the location].&quot;
</p></blockquote>
<!-- END CODE -->
<p>will count Wickham and everyone he looks at as all having been mentioned, and will not refer to them again through the rest of the room description. More complicated uses of writing a paragraph abound. A developed system for handling supporters that don't list contents appears in <span class="boldface">The Eye of the Idol</span>.</p>
<p>Inform then prints the initial appearances of objects that are marked for listing but not already mentioned; and then it performs the listing nondescript items activity, collating the remaining objects into a paragraph like</p>
<!-- START CODE "c23596" -->
<a id="c23596"></a><blockquote class="code"><p class="quoted">
You can see a dog, a hen, ...
</p></blockquote>
<!-- END CODE -->
<p>We can pre-empt items from appearing in this paragraph or change their listing by intervening with a Before listing nondescript items... rule, as in</p>
<!-- START CODE "c23597" -->
<a id="c23597"></a><blockquote class="code"><p class="quoted">
Before listing nondescript items when the player needs the watch:
<br />&#160;&#160;&#160;&#160;if the watch is marked for listing:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;The watch catches your eye.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the watch is not marked for listing.
</p></blockquote>
<!-- END CODE -->
<p>If we wanted the watch always to be listed this way, it would be better to give it an initial appearance, but for conditional cases, the listing nondescript items activity is a good place to intervene. For instance, <span class="boldface">Rip</span> uses this activity to incorporate changeable or portable items into the main description text for a room when (and only when) that is appropriate.</p>
<p>The listing nondescript items activity also allows us to replace the &quot;You can see...&quot; tag with something else more fitting, if for instance we are in a dimly lit room.</p>
<p>When the story compiles the list of nondescript items, it adds tags such as &quot;(open)&quot; or &quot;(empty)&quot; or &quot;(on which is a fish tank)&quot; to the names of containers and supporters. We can suppress or change the &quot;(empty)&quot; tag with the printing room description details of activity, as in</p>
<!-- START CODE "c23598" -->
<a id="c23598"></a><blockquote class="code"><p class="quoted">
Rule for printing room description details: stop.
</p></blockquote>
<!-- END CODE -->
<p>And we can suppress the &quot;(open)&quot; and &quot;(on which is...)&quot; sorts of tags with the &quot;omit the contents in listing&quot; phrase, as in</p>
<!-- START CODE "c23599" -->
<a id="c23599"></a><blockquote class="code"><p class="quoted">
Rule for printing the name of the bottle while not inserting or removing:
<br />&#160;&#160;&#160;&#160;if the bottle contains sand, say &quot;bottle of sand&quot;;
<br />&#160;&#160;&#160;&#160;otherwise say &quot;empty bottle&quot;;
<br />&#160;&#160;&#160;&#160;omit contents in listing.
</p></blockquote>
<!-- END CODE -->
<p>Finally, the looking command lists visible non-scenery items that sit on scenery supporters, as in</p>
<!-- START CODE "c23600" -->
<a id="c23600"></a><blockquote class="code"><p class="quoted">
On the table is a folded newspaper.
</p></blockquote>
<!-- END CODE -->
<p>These paragraphs can be manipulated with the printing the locale description activity and the printing a locale paragraph about activity.</p>
<p>Another common thing we may want to do is change the description of a room depending on whether we've been there before (as in <span class="boldface">Slightly Wrong</span>) or on how often we've visited (as in <span class="boldface">Infiltration</span>). <span class="boldface">Night Sky</span>, meanwhile, changes the description of a room when we've examined another object, so that the player's awareness of his environment is affected by other things the character knows.</p>
<p class="crossreference"><a href="RB_6_4.html" class="xreflink"><img class="asterisk" alt="*" src="Documentation/Images/xref.png" />&#160;<i>See </i><b>Looking</b></a><i> for ways to change the default length of room descriptions</i></p><hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="RB_3_1.html" class="standardlink"><img alt="arrow-up.png" src="Documentation/Images/arrow-up.png" /></a></td><td><a href="RB_3_1.html" class="standardlink">Start of Chapter 3: Place</a></td></tr>
<tr><td class="roadsigndirection"><a href="RB_2_3.html" class="standardlink"><img alt="arrow-left.png" src="Documentation/Images/arrow-left.png" /></a></td><td><a href="RB_2_3.html" class="standardlink">Back to Chapter 2: Adaptive Prose: §2.3. Using the Player's Input</a></td></tr>
<tr><td class="roadsigndirection"><a href="RB_3_2.html" class="standardlink"><img alt="arrow-right.png" src="Documentation/Images/arrow-right.png" /></a></td><td><a href="RB_3_2.html" class="standardlink">Onward to §3.2. Map</a></td></tr>
</table><hr />
</div>
<div class="bookexamples">
<p class="chapterheading"></p><a id="e266"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="Rex266.html#e266" class="eglink"><b>147</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="Rex266.html#e266" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Night Sky</span></b></a><br />A room which changes its description depending on whether an object has been examined.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="ex266.html#e266"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<a id="e224"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="Rex224.html#e224" class="eglink"><b>152</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="Rex224.html#e224" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Infiltration</span></b></a><br />A room whose description changes depending on the number of times the player has visited.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="ex224.html#e224"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<a id="e152"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<!-- EXAMPLE START -->
<a href="RB_3_1.html#e152" class="eglink"><b>334</b></a></div>
<div class="egpanel" id="example152">
<p>Suppose we want to create an object -- or maybe even a series of objects -- that warp the player's perception of every room description and object around him.</p>
<p>We've already seen some ways to create variations in text. For instance, we could make a room description with if substitutions in it, like so:</p>
<!-- START CODE "c28271" -->
<a id="c28271"></a><blockquote class="code"><p class="quoted">
The Kitchen is a room. &quot;[if the player is wearing the sunglasses]Are ants coming out of the sink? No, probably no.[otherwise]A small kitchen tucked into a corner of the vacation house. There is storage space for five or six cups, a sink, a two-ring stove; nothing else to speak of.[end if]&quot;
</p></blockquote>
<!-- END CODE -->
<p>That works fine if we have one or two variations we want to add; it's not so good if we're going to have several items that work like the sunglasses, or if we want the sunglasses to override the description of every room in the house.</p>
<p>A slightly more flexible method is to use a substitution that calls out to a say phrase, like this:</p>
<!-- START CODE "c28272" -->
<a id="c28272"></a><blockquote class="code"><p class="quoted">
The Kitchen is a room. &quot;[kitchen-description]&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28273" -->
<a id="c28273"></a><blockquote class="code"><p class="quoted">
To say kitchen-description:
<br />&#160;&#160;&#160;&#160;if the player is wearing the sunglasses:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Are ants coming out of the sink? No, probably no.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;A small kitchen tucked into a corner of the vacation house. There is storage space for five or six cups, a sink, a two-ring stove; nothing else to speak of.&quot;
</p></blockquote>
<!-- END CODE -->
<p>But again this doesn't handle the case of overriding multiple rooms at once very well.</p>
<p>When we reach a point where we need a given piece of text to be very flexible depending on the world model, it's time to use an activity.</p>
<p>Activities offer several advantages. One, we can create an activity like this:</p>
<!-- START CODE "c28274" -->
<a id="c28274"></a><blockquote class="code"><p class="quoted">
Printing the room-description of something is an activity.
</p></blockquote>
<!-- END CODE -->
<p>and then write a rule that applies to multiple rooms at once, like:</p>
<!-- START CODE "c28275" -->
<a id="c28275"></a><blockquote class="code"><p class="quoted">
Rule for printing the room-description of a room when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;The walls look like they're covered with ants. Just a coincidence, I'm sure.&quot;
</p></blockquote>
<!-- END CODE -->
<p>Inform's usual rule-ranking also means that more-specific rules will override less-specific ones, so we could add</p>
<!-- START CODE "c28276" -->
<a id="c28276"></a><blockquote class="code"><p class="quoted">
&#160;&#160;&#160;&#160;Rule for printing the room-description of the Kitchen when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;Are ants coming out of the sink? No, probably not.&quot;
</p></blockquote>
<!-- END CODE -->
<p>and have that rule override the behavior of the activity just in the kitchen. Meanwhile, our base room descriptions remain straightforward and uncluttered by if-statements.</p>
<p>Several other examples will show how to hook activities into existing actions: Crusoe goes into detail about how how to make the descriptions of things more variable, and Aftershock demonstrates activities for describing the behavior of switchable devices.</p>
<p>Here, we preview all of those methods, just to get a sense of how they work and why they might be useful in controlling a game. Subsequent chapters go into more detail about the syntax of creating activities and the list of activities that are already defined by Inform.</p>
<!-- START CODE "c28277" -->
<a id="c28277"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode(' [=0x0022=]Ant-Sensitive Sunglasses[=0x0022=][=0x000A=][=0x000A=]Part 1 - Procedure[=0x000A=][=0x000A=][To add a new activity to an existing Inform rule, we need to do three things:][=0x000A=][=0x000A=][1) Define our new activity.][=0x000A=][2) Give a basic rule that says what is supposed to happen when that activity occurs, as in [=0x0022=]Rule for...[=0x0022=]][=0x000A=][3) Replace the existing rule in Inform[=0x0027=]s rulebooks with a new one that calls on our activity.][=0x000A=][=0x000A=][Here we do this with examining:][=0x000A=][=0x000A=]Section 1 - Item Description[=0x000A=][=0x000A=]Printing the description of something is an activity.[=0x000A=][=0x000A=][Now, by default, we want to print the description property; we just want the option to write some extra rules overriding that property. So we tell Inform that our most basic rule for printing the description of something is just to give that description text:][=0x000A=][=0x000A=]Rule for printing the description of something (called item):[=0x000A=][=0x0009=]if the description of the item is not [=0x0022=][=0x0022=]:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][description of item][paragraph break][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]You see nothing special about [the item].[=0x0022=].[=0x000A=][=0x000A=][Next, we need the standard examining rule to look at our printing-the-description activity:][=0x000A=][=0x000A=]The activity-based examining rule is listed instead of the standard examining rule in the carry out examining rules.[=0x000A=][=0x000A=]This is the activity-based examining rule:[=0x000A=][=0x0009=]carry out the printing the description activity with the noun;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=][Now we do the same thing to room descriptions.][=0x000A=][=0x000A=]Section 2 - Room Description[=0x000A=][=0x000A=]Printing the room-description of something is an activity.[=0x000A=][=0x000A=]Rule for printing the room-description of a room (called item):[=0x000A=][=0x0009=]if the description of the item is not [=0x0022=][=0x0022=]:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][description of item][paragraph break][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]do nothing instead.[=0x000A=][=0x000A=]The activity-based room description body text rule is listed instead of the room description body text rule in the carry out looking rules.[=0x000A=][=0x000A=][Our replacement rule this time around is a little bit trickier just because the rule that we[=0x0027=]re replacing is a complicated one: describing a room already checks to see whether there[=0x0027=]s light to see by, whether the player has turned off room descriptions when he enters a room for the second time, and whether the player character is (say) inside a closed box he can[=0x0027=]t see out of.][=0x000A=][=0x000A=][But all of those details are re-copied from the standard rules, and the important thing is that, at the end, we again carry out our activity.][=0x000A=][=0x000A=]This is the activity-based room description body text rule:[=0x000A=][=0x0009=]if the visibility level count is 0:[=0x000A=][=0x0009=][=0x0009=]if set to abbreviated room descriptions, continue the action;[=0x000A=][=0x0009=][=0x0009=]if set to sometimes abbreviated room descriptions and[=0x000A=][=0x0009=][=0x0009=][=0x0009=]abbreviated form allowed is true and[=0x000A=][=0x0009=][=0x0009=][=0x0009=]darkness witnessed is true,[=0x000A=][=0x0009=][=0x0009=][=0x0009=]continue the action;[=0x000A=][=0x0009=][=0x0009=]begin the printing the description of a dark room activity;[=0x000A=][=0x0009=][=0x0009=]if handling the printing the description of a dark room activity,[=0x000A=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=]It is pitch dark, and you can[=0x0027=]t see a thing.[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]end the printing the description of a dark room activity;[=0x000A=][=0x0009=]otherwise if the visibility ceiling is the location:[=0x000A=][=0x0009=][=0x0009=]if set to abbreviated room descriptions, continue the action;[=0x000A=][=0x0009=][=0x0009=]if set to sometimes abbreviated room descriptions and abbreviated form[=0x000A=][=0x0009=][=0x0009=][=0x0009=]allowed is true and the location is visited, continue the action;[=0x000A=][=0x0009=][=0x0009=]carry out the printing the room-description activity with the location.[=0x000A=][=0x000A=]Section 3 - Device Description[=0x000A=][=0x000A=]Showing action of something is an activity.[=0x000A=][=0x000A=]Rule for showing action of something (called item):[=0x000A=][=0x0009=]if the item is switched on, say [=0x0022=][The item] is switched on.[=0x0022=];[=0x000A=][=0x0009=]otherwise say [=0x0022=][The item] is switched off.[=0x0022=][=0x000A=][=0x000A=]The activity-based described devices rule is listed instead of the examine devices rule in the carry out examining rules.[=0x000A=][=0x000A=]This is the activity-based described devices rule:[=0x000A=][=0x0009=]if the noun is a device:[=0x000A=][=0x0009=][=0x0009=]carry out the showing action activity with the noun;[=0x000A=][=0x0009=][=0x0009=]now examine text printed is true.[=0x000A=][=0x000A=]Report switching on something:[=0x000A=][=0x0009=]say [=0x0022=]You flip a switch. [=0x0022=];[=0x000A=][=0x0009=]carry out the showing action activity with the noun instead.[=0x000A=][=0x000A=]Part 2 - Scenario[=0x000A=][=0x000A=]The Kitchen is a room. [=0x0022=]A small kitchen tucked into a corner of the vacation house. There is storage space for five or six cups, a sink, a two-ring stove; nothing else to speak of.[=0x0022=][=0x000A=][=0x000A=]The microwave is a device in the Kitchen.[=0x000A=][=0x000A=]South of the Kitchen is the Living Area. The description of the Living area is [=0x0022=]A whitewashed living/dining/reclining area in what used to be a shepherd[=0x0027=]s stone hut, but now costs vacationers 600 euros a week. It offers no mod cons, only a straight view of the Mediterranean and a wobbly writing table.[=0x0022=][=0x000A=][=0x000A=]Rule for printing the room-description of a room when the player wears the sunglasses:[=0x000A=][=0x0009=]say [=0x0022=]The walls look like they[=0x0027=]re covered with ants. Just a coincidence, I[=0x0027=]m sure[antsy].[=0x0022=][=0x000A=][=0x000A=]Rule for printing the room-description of the Kitchen when the player wears the sunglasses:[=0x000A=][=0x0009=]say [=0x0022=]Are ants coming out of the sink? No, probably not[antsy].[=0x0022=][=0x000A=][=0x000A=]Rule for printing the description of something (called the item) when the player wears the sunglasses:[=0x000A=][=0x0009=]say [=0x0022=][The item] [are] [one of]ant-colored[or]ant-legged[or]covered in ants[at random][antsy].[=0x0022=][=0x000A=][=0x000A=]Rule for showing action of the microwave:[=0x000A=][=0x0009=]say [=0x0022=]The microwave hums meaningfully to itself.[=0x0022=][=0x000A=][=0x000A=]Rule for showing action of the microwave when the player wears the sunglasses:[=0x000A=][=0x0009=]say [=0x0022=]The microwave hums as though inhabited by a billion ants[antsy].[=0x0022=][=0x000A=][=0x000A=]The player carries sunglasses of freakiness and an apple. The apple is edible. The sunglasses are wearable.[=0x000A=][=0x000A=]ant-paranoia is a number that varies.[=0x000A=][=0x000A=]To say antsy:[=0x000A=][=0x0009=]increase ant-paranoia by 1;[=0x000A=][=0x000A=]Every turn:[=0x000A=][=0x0009=]if the ant-paranoia is greater than 3:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]Augh! AUUUGH! GET THEM OFF--[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]end the story saying [=0x0022=]You have lost your mind.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]look / turn on microwave / turn off microwave / x apple / x sunglasses / s / wear sunglasses / look / x apple / n / turn on microwave[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="Documentation/Images/paste.png" /></a>  &quot;Ant-Sensitive Sunglasses&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28278" -->
<a id="c28278"></a><blockquote class="code"><p class="quoted">
Part 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<p>To add a new activity to an existing Inform rule, we need to do three things:</p>
<p>1) Define our new activity.</p>
<p>2) Give a basic rule that says what is supposed to happen when that activity occurs, as in &quot;Rule for...&quot;</p>
<p>3) Replace the existing rule in Inform's rulebooks with a new one that calls on our activity.</p>
<p>Here we do this with examining:</p>
<!-- START CODE "c28279" -->
<a id="c28279"></a><blockquote class="code"><p class="quoted">
Section 1 - Item Description
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28280" -->
<a id="c28280"></a><blockquote class="code"><p class="quoted">
Printing the description of something is an activity.
</p></blockquote>
<!-- END CODE -->
<p>Now, by default, we want to print the description property; we just want the option to write some extra rules overriding that property. So we tell Inform that our most basic rule for printing the description of something is just to give that description text:</p>
<!-- START CODE "c28281" -->
<a id="c28281"></a><blockquote class="code"><p class="quoted">
Rule for printing the description of something (called item):
<br />&#160;&#160;&#160;&#160;if the description of the item is not &quot;&quot;:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[description of item][paragraph break]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You see nothing special about [the item].&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Next, we need the standard examining rule to look at our printing-the-description activity:</p>
<!-- START CODE "c28282" -->
<a id="c28282"></a><blockquote class="code"><p class="quoted">
The activity-based examining rule is listed instead of the standard examining rule in the carry out examining rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28283" -->
<a id="c28283"></a><blockquote class="code"><p class="quoted">
This is the activity-based examining rule:
<br />&#160;&#160;&#160;&#160;carry out the printing the description activity with the noun;
<br />&#160;&#160;&#160;&#160;rule succeeds.
</p></blockquote>
<!-- END CODE -->
<p>Now we do the same thing to room descriptions.</p>
<!-- START CODE "c28284" -->
<a id="c28284"></a><blockquote class="code"><p class="quoted">
Section 2 - Room Description
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28285" -->
<a id="c28285"></a><blockquote class="code"><p class="quoted">
Printing the room-description of something is an activity.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28286" -->
<a id="c28286"></a><blockquote class="code"><p class="quoted">
Rule for printing the room-description of a room (called item):
<br />&#160;&#160;&#160;&#160;if the description of the item is not &quot;&quot;:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[description of item][paragraph break]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;do nothing instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28287" -->
<a id="c28287"></a><blockquote class="code"><p class="quoted">
The activity-based room description body text rule is listed instead of the room description body text rule in the carry out looking rules.
</p></blockquote>
<!-- END CODE -->
<p>Our replacement rule this time around is a little bit trickier just because the rule that we're replacing is a complicated one: describing a room already checks to see whether there's light to see by, whether the player has turned off room descriptions when he enters a room for the second time, and whether the player character is (say) inside a closed box he can't see out of.</p>
<p>But all of those details are re-copied from the standard rules, and the important thing is that, at the end, we again carry out our activity.</p>
<!-- START CODE "c28288" -->
<a id="c28288"></a><blockquote class="code"><p class="quoted">
This is the activity-based room description body text rule:
<br />&#160;&#160;&#160;&#160;if the visibility level count is 0:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if set to abbreviated room descriptions, continue the action;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if set to sometimes abbreviated room descriptions and
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;abbreviated form allowed is true and
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;darkness witnessed is true,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;continue the action;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;begin the printing the description of a dark room activity;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if handling the printing the description of a dark room activity,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;It is pitch dark, and you can't see a thing.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end the printing the description of a dark room activity;
<br />&#160;&#160;&#160;&#160;otherwise if the visibility ceiling is the location:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if set to abbreviated room descriptions, continue the action;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if set to sometimes abbreviated room descriptions and abbreviated form
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;allowed is true and the location is visited, continue the action;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;carry out the printing the room-description activity with the location.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28289" -->
<a id="c28289"></a><blockquote class="code"><p class="quoted">
Section 3 - Device Description
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28290" -->
<a id="c28290"></a><blockquote class="code"><p class="quoted">
Showing action of something is an activity.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28291" -->
<a id="c28291"></a><blockquote class="code"><p class="quoted">
Rule for showing action of something (called item):
<br />&#160;&#160;&#160;&#160;if the item is switched on, say &quot;[The item] is switched on.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise say &quot;[The item] is switched off.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28292" -->
<a id="c28292"></a><blockquote class="code"><p class="quoted">
The activity-based described devices rule is listed instead of the examine devices rule in the carry out examining rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28293" -->
<a id="c28293"></a><blockquote class="code"><p class="quoted">
This is the activity-based described devices rule:
<br />&#160;&#160;&#160;&#160;if the noun is a device:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;carry out the showing action activity with the noun;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now examine text printed is true.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28294" -->
<a id="c28294"></a><blockquote class="code"><p class="quoted">
Report switching on something:
<br />&#160;&#160;&#160;&#160;say &quot;You flip a switch. &quot;;
<br />&#160;&#160;&#160;&#160;carry out the showing action activity with the noun instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28295" -->
<a id="c28295"></a><blockquote class="code"><p class="quoted">
Part 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28296" -->
<a id="c28296"></a><blockquote class="code"><p class="quoted">
The Kitchen is a room. &quot;A small kitchen tucked into a corner of the vacation house. There is storage space for five or six cups, a sink, a two-ring stove; nothing else to speak of.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28297" -->
<a id="c28297"></a><blockquote class="code"><p class="quoted">
The microwave is a device in the Kitchen.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28298" -->
<a id="c28298"></a><blockquote class="code"><p class="quoted">
South of the Kitchen is the Living Area. The description of the Living area is &quot;A whitewashed living/dining/reclining area in what used to be a shepherd's stone hut, but now costs vacationers 600 euros a week. It offers no mod cons, only a straight view of the Mediterranean and a wobbly writing table.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28299" -->
<a id="c28299"></a><blockquote class="code"><p class="quoted">
Rule for printing the room-description of a room when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;The walls look like they're covered with ants. Just a coincidence, I'm sure[antsy].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28300" -->
<a id="c28300"></a><blockquote class="code"><p class="quoted">
Rule for printing the room-description of the Kitchen when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;Are ants coming out of the sink? No, probably not[antsy].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28301" -->
<a id="c28301"></a><blockquote class="code"><p class="quoted">
Rule for printing the description of something (called the item) when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] [one of]ant-colored[or]ant-legged[or]covered in ants[at random][antsy].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28302" -->
<a id="c28302"></a><blockquote class="code"><p class="quoted">
Rule for showing action of the microwave:
<br />&#160;&#160;&#160;&#160;say &quot;The microwave hums meaningfully to itself.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28303" -->
<a id="c28303"></a><blockquote class="code"><p class="quoted">
Rule for showing action of the microwave when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;The microwave hums as though inhabited by a billion ants[antsy].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28304" -->
<a id="c28304"></a><blockquote class="code"><p class="quoted">
The player carries sunglasses of freakiness and an apple. The apple is edible. The sunglasses are wearable.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28305" -->
<a id="c28305"></a><blockquote class="code"><p class="quoted">
ant-paranoia is a number that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28306" -->
<a id="c28306"></a><blockquote class="code"><p class="quoted">
To say antsy:
<br />&#160;&#160;&#160;&#160;increase ant-paranoia by 1;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28307" -->
<a id="c28307"></a><blockquote class="code"><p class="quoted">
Every turn:
<br />&#160;&#160;&#160;&#160;if the ant-paranoia is greater than 3:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Augh! AUUUGH! GET THEM OFF--&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end the story saying &quot;You have lost your mind.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28308" -->
<a id="c28308"></a><blockquote class="code"><p class="quoted">
Test me with &quot;look / turn on microwave / turn off microwave / x apple / x sunglasses / s / wear sunglasses / look / x apple / n / turn on microwave&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<!-- EXAMPLE END -->
<!-- EXAMPLE START -->
</td><td class="egnamecell"><p class="egcuetext"><a href="RB_3_1.html#e152" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner"><b>Example</b></span><span class="egname">Ant-Sensitive Sunglasses</span></b></a><br />What are activities good for? Controlling output when we want the same action to be able to produce very flexible text depending on the state of the world -- in this case, making highly variable room description and object description text.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egpanel" id="example152">
<p>Suppose we want to create an object -- or maybe even a series of objects -- that warp the player's perception of every room description and object around him.</p>
<p>We've already seen some ways to create variations in text. For instance, we could make a room description with if substitutions in it, like so:</p>
<!-- START CODE "c28309" -->
<a id="c28309"></a><blockquote class="code"><p class="quoted">
The Kitchen is a room. &quot;[if the player is wearing the sunglasses]Are ants coming out of the sink? No, probably no.[otherwise]A small kitchen tucked into a corner of the vacation house. There is storage space for five or six cups, a sink, a two-ring stove; nothing else to speak of.[end if]&quot;
</p></blockquote>
<!-- END CODE -->
<p>That works fine if we have one or two variations we want to add; it's not so good if we're going to have several items that work like the sunglasses, or if we want the sunglasses to override the description of every room in the house.</p>
<p>A slightly more flexible method is to use a substitution that calls out to a say phrase, like this:</p>
<!-- START CODE "c28310" -->
<a id="c28310"></a><blockquote class="code"><p class="quoted">
The Kitchen is a room. &quot;[kitchen-description]&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28311" -->
<a id="c28311"></a><blockquote class="code"><p class="quoted">
To say kitchen-description:
<br />&#160;&#160;&#160;&#160;if the player is wearing the sunglasses:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Are ants coming out of the sink? No, probably no.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;A small kitchen tucked into a corner of the vacation house. There is storage space for five or six cups, a sink, a two-ring stove; nothing else to speak of.&quot;
</p></blockquote>
<!-- END CODE -->
<p>But again this doesn't handle the case of overriding multiple rooms at once very well.</p>
<p>When we reach a point where we need a given piece of text to be very flexible depending on the world model, it's time to use an activity.</p>
<p>Activities offer several advantages. One, we can create an activity like this:</p>
<!-- START CODE "c28312" -->
<a id="c28312"></a><blockquote class="code"><p class="quoted">
Printing the room-description of something is an activity.
</p></blockquote>
<!-- END CODE -->
<p>and then write a rule that applies to multiple rooms at once, like:</p>
<!-- START CODE "c28313" -->
<a id="c28313"></a><blockquote class="code"><p class="quoted">
Rule for printing the room-description of a room when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;The walls look like they're covered with ants. Just a coincidence, I'm sure.&quot;
</p></blockquote>
<!-- END CODE -->
<p>Inform's usual rule-ranking also means that more-specific rules will override less-specific ones, so we could add</p>
<!-- START CODE "c28314" -->
<a id="c28314"></a><blockquote class="code"><p class="quoted">
&#160;&#160;&#160;&#160;Rule for printing the room-description of the Kitchen when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;Are ants coming out of the sink? No, probably not.&quot;
</p></blockquote>
<!-- END CODE -->
<p>and have that rule override the behavior of the activity just in the kitchen. Meanwhile, our base room descriptions remain straightforward and uncluttered by if-statements.</p>
<p>Several other examples will show how to hook activities into existing actions: Crusoe goes into detail about how how to make the descriptions of things more variable, and Aftershock demonstrates activities for describing the behavior of switchable devices.</p>
<p>Here, we preview all of those methods, just to get a sense of how they work and why they might be useful in controlling a game. Subsequent chapters go into more detail about the syntax of creating activities and the list of activities that are already defined by Inform.</p>
<!-- START CODE "c28315" -->
<a id="c28315"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode(' [=0x0022=]Ant-Sensitive Sunglasses[=0x0022=][=0x000A=][=0x000A=]Part 1 - Procedure[=0x000A=][=0x000A=][To add a new activity to an existing Inform rule, we need to do three things:][=0x000A=][=0x000A=][1) Define our new activity.][=0x000A=][2) Give a basic rule that says what is supposed to happen when that activity occurs, as in [=0x0022=]Rule for...[=0x0022=]][=0x000A=][3) Replace the existing rule in Inform[=0x0027=]s rulebooks with a new one that calls on our activity.][=0x000A=][=0x000A=][Here we do this with examining:][=0x000A=][=0x000A=]Section 1 - Item Description[=0x000A=][=0x000A=]Printing the description of something is an activity.[=0x000A=][=0x000A=][Now, by default, we want to print the description property; we just want the option to write some extra rules overriding that property. So we tell Inform that our most basic rule for printing the description of something is just to give that description text:][=0x000A=][=0x000A=]Rule for printing the description of something (called item):[=0x000A=][=0x0009=]if the description of the item is not [=0x0022=][=0x0022=]:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][description of item][paragraph break][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]You see nothing special about [the item].[=0x0022=].[=0x000A=][=0x000A=][Next, we need the standard examining rule to look at our printing-the-description activity:][=0x000A=][=0x000A=]The activity-based examining rule is listed instead of the standard examining rule in the carry out examining rules.[=0x000A=][=0x000A=]This is the activity-based examining rule:[=0x000A=][=0x0009=]carry out the printing the description activity with the noun;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=][Now we do the same thing to room descriptions.][=0x000A=][=0x000A=]Section 2 - Room Description[=0x000A=][=0x000A=]Printing the room-description of something is an activity.[=0x000A=][=0x000A=]Rule for printing the room-description of a room (called item):[=0x000A=][=0x0009=]if the description of the item is not [=0x0022=][=0x0022=]:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][description of item][paragraph break][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]do nothing instead.[=0x000A=][=0x000A=]The activity-based room description body text rule is listed instead of the room description body text rule in the carry out looking rules.[=0x000A=][=0x000A=][Our replacement rule this time around is a little bit trickier just because the rule that we[=0x0027=]re replacing is a complicated one: describing a room already checks to see whether there[=0x0027=]s light to see by, whether the player has turned off room descriptions when he enters a room for the second time, and whether the player character is (say) inside a closed box he can[=0x0027=]t see out of.][=0x000A=][=0x000A=][But all of those details are re-copied from the standard rules, and the important thing is that, at the end, we again carry out our activity.][=0x000A=][=0x000A=]This is the activity-based room description body text rule:[=0x000A=][=0x0009=]if the visibility level count is 0:[=0x000A=][=0x0009=][=0x0009=]if set to abbreviated room descriptions, continue the action;[=0x000A=][=0x0009=][=0x0009=]if set to sometimes abbreviated room descriptions and[=0x000A=][=0x0009=][=0x0009=][=0x0009=]abbreviated form allowed is true and[=0x000A=][=0x0009=][=0x0009=][=0x0009=]darkness witnessed is true,[=0x000A=][=0x0009=][=0x0009=][=0x0009=]continue the action;[=0x000A=][=0x0009=][=0x0009=]begin the printing the description of a dark room activity;[=0x000A=][=0x0009=][=0x0009=]if handling the printing the description of a dark room activity,[=0x000A=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=]It is pitch dark, and you can[=0x0027=]t see a thing.[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]end the printing the description of a dark room activity;[=0x000A=][=0x0009=]otherwise if the visibility ceiling is the location:[=0x000A=][=0x0009=][=0x0009=]if set to abbreviated room descriptions, continue the action;[=0x000A=][=0x0009=][=0x0009=]if set to sometimes abbreviated room descriptions and abbreviated form[=0x000A=][=0x0009=][=0x0009=][=0x0009=]allowed is true and the location is visited, continue the action;[=0x000A=][=0x0009=][=0x0009=]carry out the printing the room-description activity with the location.[=0x000A=][=0x000A=]Section 3 - Device Description[=0x000A=][=0x000A=]Showing action of something is an activity.[=0x000A=][=0x000A=]Rule for showing action of something (called item):[=0x000A=][=0x0009=]if the item is switched on, say [=0x0022=][The item] is switched on.[=0x0022=];[=0x000A=][=0x0009=]otherwise say [=0x0022=][The item] is switched off.[=0x0022=][=0x000A=][=0x000A=]The activity-based described devices rule is listed instead of the examine devices rule in the carry out examining rules.[=0x000A=][=0x000A=]This is the activity-based described devices rule:[=0x000A=][=0x0009=]if the noun is a device:[=0x000A=][=0x0009=][=0x0009=]carry out the showing action activity with the noun;[=0x000A=][=0x0009=][=0x0009=]now examine text printed is true.[=0x000A=][=0x000A=]Report switching on something:[=0x000A=][=0x0009=]say [=0x0022=]You flip a switch. [=0x0022=];[=0x000A=][=0x0009=]carry out the showing action activity with the noun instead.[=0x000A=][=0x000A=]Part 2 - Scenario[=0x000A=][=0x000A=]The Kitchen is a room. [=0x0022=]A small kitchen tucked into a corner of the vacation house. There is storage space for five or six cups, a sink, a two-ring stove; nothing else to speak of.[=0x0022=][=0x000A=][=0x000A=]The microwave is a device in the Kitchen.[=0x000A=][=0x000A=]South of the Kitchen is the Living Area. The description of the Living area is [=0x0022=]A whitewashed living/dining/reclining area in what used to be a shepherd[=0x0027=]s stone hut, but now costs vacationers 600 euros a week. It offers no mod cons, only a straight view of the Mediterranean and a wobbly writing table.[=0x0022=][=0x000A=][=0x000A=]Rule for printing the room-description of a room when the player wears the sunglasses:[=0x000A=][=0x0009=]say [=0x0022=]The walls look like they[=0x0027=]re covered with ants. Just a coincidence, I[=0x0027=]m sure[antsy].[=0x0022=][=0x000A=][=0x000A=]Rule for printing the room-description of the Kitchen when the player wears the sunglasses:[=0x000A=][=0x0009=]say [=0x0022=]Are ants coming out of the sink? No, probably not[antsy].[=0x0022=][=0x000A=][=0x000A=]Rule for printing the description of something (called the item) when the player wears the sunglasses:[=0x000A=][=0x0009=]say [=0x0022=][The item] [are] [one of]ant-colored[or]ant-legged[or]covered in ants[at random][antsy].[=0x0022=][=0x000A=][=0x000A=]Rule for showing action of the microwave:[=0x000A=][=0x0009=]say [=0x0022=]The microwave hums meaningfully to itself.[=0x0022=][=0x000A=][=0x000A=]Rule for showing action of the microwave when the player wears the sunglasses:[=0x000A=][=0x0009=]say [=0x0022=]The microwave hums as though inhabited by a billion ants[antsy].[=0x0022=][=0x000A=][=0x000A=]The player carries sunglasses of freakiness and an apple. The apple is edible. The sunglasses are wearable.[=0x000A=][=0x000A=]ant-paranoia is a number that varies.[=0x000A=][=0x000A=]To say antsy:[=0x000A=][=0x0009=]increase ant-paranoia by 1;[=0x000A=][=0x000A=]Every turn:[=0x000A=][=0x0009=]if the ant-paranoia is greater than 3:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]Augh! AUUUGH! GET THEM OFF--[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]end the story saying [=0x0022=]You have lost your mind.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]look / turn on microwave / turn off microwave / x apple / x sunglasses / s / wear sunglasses / look / x apple / n / turn on microwave[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="Documentation/Images/paste.png" /></a>  &quot;Ant-Sensitive Sunglasses&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28316" -->
<a id="c28316"></a><blockquote class="code"><p class="quoted">
Part 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<p>To add a new activity to an existing Inform rule, we need to do three things:</p>
<p>1) Define our new activity.</p>
<p>2) Give a basic rule that says what is supposed to happen when that activity occurs, as in &quot;Rule for...&quot;</p>
<p>3) Replace the existing rule in Inform's rulebooks with a new one that calls on our activity.</p>
<p>Here we do this with examining:</p>
<!-- START CODE "c28317" -->
<a id="c28317"></a><blockquote class="code"><p class="quoted">
Section 1 - Item Description
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28318" -->
<a id="c28318"></a><blockquote class="code"><p class="quoted">
Printing the description of something is an activity.
</p></blockquote>
<!-- END CODE -->
<p>Now, by default, we want to print the description property; we just want the option to write some extra rules overriding that property. So we tell Inform that our most basic rule for printing the description of something is just to give that description text:</p>
<!-- START CODE "c28319" -->
<a id="c28319"></a><blockquote class="code"><p class="quoted">
Rule for printing the description of something (called item):
<br />&#160;&#160;&#160;&#160;if the description of the item is not &quot;&quot;:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[description of item][paragraph break]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You see nothing special about [the item].&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Next, we need the standard examining rule to look at our printing-the-description activity:</p>
<!-- START CODE "c28320" -->
<a id="c28320"></a><blockquote class="code"><p class="quoted">
The activity-based examining rule is listed instead of the standard examining rule in the carry out examining rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28321" -->
<a id="c28321"></a><blockquote class="code"><p class="quoted">
This is the activity-based examining rule:
<br />&#160;&#160;&#160;&#160;carry out the printing the description activity with the noun;
<br />&#160;&#160;&#160;&#160;rule succeeds.
</p></blockquote>
<!-- END CODE -->
<p>Now we do the same thing to room descriptions.</p>
<!-- START CODE "c28322" -->
<a id="c28322"></a><blockquote class="code"><p class="quoted">
Section 2 - Room Description
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28323" -->
<a id="c28323"></a><blockquote class="code"><p class="quoted">
Printing the room-description of something is an activity.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28324" -->
<a id="c28324"></a><blockquote class="code"><p class="quoted">
Rule for printing the room-description of a room (called item):
<br />&#160;&#160;&#160;&#160;if the description of the item is not &quot;&quot;:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[description of item][paragraph break]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;do nothing instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28325" -->
<a id="c28325"></a><blockquote class="code"><p class="quoted">
The activity-based room description body text rule is listed instead of the room description body text rule in the carry out looking rules.
</p></blockquote>
<!-- END CODE -->
<p>Our replacement rule this time around is a little bit trickier just because the rule that we're replacing is a complicated one: describing a room already checks to see whether there's light to see by, whether the player has turned off room descriptions when he enters a room for the second time, and whether the player character is (say) inside a closed box he can't see out of.</p>
<p>But all of those details are re-copied from the standard rules, and the important thing is that, at the end, we again carry out our activity.</p>
<!-- START CODE "c28326" -->
<a id="c28326"></a><blockquote class="code"><p class="quoted">
This is the activity-based room description body text rule:
<br />&#160;&#160;&#160;&#160;if the visibility level count is 0:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if set to abbreviated room descriptions, continue the action;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if set to sometimes abbreviated room descriptions and
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;abbreviated form allowed is true and
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;darkness witnessed is true,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;continue the action;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;begin the printing the description of a dark room activity;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if handling the printing the description of a dark room activity,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;It is pitch dark, and you can't see a thing.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end the printing the description of a dark room activity;
<br />&#160;&#160;&#160;&#160;otherwise if the visibility ceiling is the location:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if set to abbreviated room descriptions, continue the action;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if set to sometimes abbreviated room descriptions and abbreviated form
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;allowed is true and the location is visited, continue the action;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;carry out the printing the room-description activity with the location.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28327" -->
<a id="c28327"></a><blockquote class="code"><p class="quoted">
Section 3 - Device Description
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28328" -->
<a id="c28328"></a><blockquote class="code"><p class="quoted">
Showing action of something is an activity.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28329" -->
<a id="c28329"></a><blockquote class="code"><p class="quoted">
Rule for showing action of something (called item):
<br />&#160;&#160;&#160;&#160;if the item is switched on, say &quot;[The item] is switched on.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise say &quot;[The item] is switched off.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28330" -->
<a id="c28330"></a><blockquote class="code"><p class="quoted">
The activity-based described devices rule is listed instead of the examine devices rule in the carry out examining rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28331" -->
<a id="c28331"></a><blockquote class="code"><p class="quoted">
This is the activity-based described devices rule:
<br />&#160;&#160;&#160;&#160;if the noun is a device:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;carry out the showing action activity with the noun;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now examine text printed is true.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28332" -->
<a id="c28332"></a><blockquote class="code"><p class="quoted">
Report switching on something:
<br />&#160;&#160;&#160;&#160;say &quot;You flip a switch. &quot;;
<br />&#160;&#160;&#160;&#160;carry out the showing action activity with the noun instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28333" -->
<a id="c28333"></a><blockquote class="code"><p class="quoted">
Part 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28334" -->
<a id="c28334"></a><blockquote class="code"><p class="quoted">
The Kitchen is a room. &quot;A small kitchen tucked into a corner of the vacation house. There is storage space for five or six cups, a sink, a two-ring stove; nothing else to speak of.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28335" -->
<a id="c28335"></a><blockquote class="code"><p class="quoted">
The microwave is a device in the Kitchen.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28336" -->
<a id="c28336"></a><blockquote class="code"><p class="quoted">
South of the Kitchen is the Living Area. The description of the Living area is &quot;A whitewashed living/dining/reclining area in what used to be a shepherd's stone hut, but now costs vacationers 600 euros a week. It offers no mod cons, only a straight view of the Mediterranean and a wobbly writing table.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28337" -->
<a id="c28337"></a><blockquote class="code"><p class="quoted">
Rule for printing the room-description of a room when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;The walls look like they're covered with ants. Just a coincidence, I'm sure[antsy].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28338" -->
<a id="c28338"></a><blockquote class="code"><p class="quoted">
Rule for printing the room-description of the Kitchen when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;Are ants coming out of the sink? No, probably not[antsy].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28339" -->
<a id="c28339"></a><blockquote class="code"><p class="quoted">
Rule for printing the description of something (called the item) when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] [one of]ant-colored[or]ant-legged[or]covered in ants[at random][antsy].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28340" -->
<a id="c28340"></a><blockquote class="code"><p class="quoted">
Rule for showing action of the microwave:
<br />&#160;&#160;&#160;&#160;say &quot;The microwave hums meaningfully to itself.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28341" -->
<a id="c28341"></a><blockquote class="code"><p class="quoted">
Rule for showing action of the microwave when the player wears the sunglasses:
<br />&#160;&#160;&#160;&#160;say &quot;The microwave hums as though inhabited by a billion ants[antsy].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28342" -->
<a id="c28342"></a><blockquote class="code"><p class="quoted">
The player carries sunglasses of freakiness and an apple. The apple is edible. The sunglasses are wearable.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28343" -->
<a id="c28343"></a><blockquote class="code"><p class="quoted">
ant-paranoia is a number that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28344" -->
<a id="c28344"></a><blockquote class="code"><p class="quoted">
To say antsy:
<br />&#160;&#160;&#160;&#160;increase ant-paranoia by 1;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28345" -->
<a id="c28345"></a><blockquote class="code"><p class="quoted">
Every turn:
<br />&#160;&#160;&#160;&#160;if the ant-paranoia is greater than 3:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Augh! AUUUGH! GET THEM OFF--&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end the story saying &quot;You have lost your mind.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c28346" -->
<a id="c28346"></a><blockquote class="code"><p class="quoted">
Test me with &quot;look / turn on microwave / turn off microwave / x apple / x sunglasses / s / wear sunglasses / look / x apple / n / turn on microwave&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<!-- EXAMPLE END -->
<div class="egovalforxref overstruckimage">
<a  href="ex152.html#e152"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<a id="e116"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="Rex116.html#e116" class="eglink"><b>355</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="Rex116.html#e116" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Rip Van Winkle</span></b></a><br />A simple way to allow objects in certain places to be described in the room description body text rather than in paragraphs following the room description.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="ex116.html#e116"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<a id="e150"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="Rex150.html#e150" class="eglink"><b>358</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="Rex150.html#e150" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Priority Lab</span></b></a><br />A debugging rule useful for checking the priorities of objects about to be listed.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="ex150.html#e150"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<a id="e93"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="Rex93.html#e93" class="eglink"><b>359</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="Rex93.html#e93" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Low Light</span></b></a><br />An object that is only visible and manipulable when a bright light fixture is on.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="ex93.html#e93"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<a id="e97"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="Rex97.html#e97" class="eglink"><b>4</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="Rex97.html#e97" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Slightly Wrong</span></b></a><br />A room whose description changes slightly after our first visit there.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="ex97.html#e97"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<a id="e156"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="Rex156.html#e156" class="eglink"><b>356</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="Rex156.html#e156" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">The Eye of the Idol</span></b></a><br />A systematic way to allow objects in certain places to be described in the room description body text rather than in paragraphs following the room description, and to control whether supporters list their contents or not.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="ex156.html#e156"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<a id="e90"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="Rex90.html#e90" class="eglink"><b>362</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="Rex90.html#e90" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Copper River</span></b></a><br />Manipulating room descriptions so that only interesting items are mentioned, while objects that are present but not currently useful to the player are ignored.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="ex90.html#e90"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
</body>
</html>
