<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 29 May 2018 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_RB.css" rel="stylesheet" type="text/css" />
<title>10.3. Dispensers and Supplies of Small Objects</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'Documentation/Images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'Documentation/Images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'Documentation/Images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'Documentation/Images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>
<p class="sectionheading">ยง10.3. Dispensers and Supplies of Small Objects</p>
<p>A slightly tricky situation arises in IF when we want to offer the player a simulation of a near-infinite supply of something: a napkin dispenser from which he can keep taking more napkins, or an infinite selection of pebbles on a beach, or something of that nature.</p>
<p>One approach is simply to limit the number of items the player is allowed to pick up at a time, while maintaining the fiction that there are more of these items in existence than the player is allowed to interact with. <span class="boldface">Extra Supplies</span> demonstrates this.</p>
<p>The task becomes harder if we do want to let the player have as many napkins as he wants. In some languages, it is possible to generate new objects on the fly after the story has begun (called &quot;dynamic object creation&quot;), and something like this is possible if we are compiling for Glulx. (See the Inform extensions site for examples.) Usually, though, it is less complicated and almost as effective simply to have a very large supply of existing objects, which are moved in and out of play as the player needs them. <span class="boldface">Pizza Prince</span> demonstrates how to do this with slices of pizza.</p>
<p class="crossreference"><a href="RB_10_6.html" class="xreflink"><img class="asterisk" alt="*" src="Documentation/Images/xref.png" />&#160;<i>See </i><b>Ropes</b></a><i> for an example involving divisible pieces of string, which relies on similar techniques</i></p><hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="RB_10_1.html" class="standardlink"><img alt="arrow-up.png" src="Documentation/Images/arrow-up.png" /></a></td><td><a href="RB_10_1.html" class="standardlink">Start of Chapter 10: Physics: Substances, Ropes, Energy and Weight</a></td></tr>
<tr><td class="roadsigndirection"><a href="RB_10_2.html" class="standardlink"><img alt="arrow-left.png" src="Documentation/Images/arrow-left.png" /></a></td><td><a href="RB_10_2.html" class="standardlink">Back to ยง10.2. Liquids</a></td></tr>
<tr><td class="roadsigndirection"><a href="RB_10_4.html" class="standardlink"><img alt="arrow-right.png" src="Documentation/Images/arrow-right.png" /></a></td><td><a href="RB_10_4.html" class="standardlink">Onward to ยง10.4. Glass and Other Damage-Prone Substances</a></td></tr>
</table><hr />
</div>
<div class="bookexamples">
<p class="chapterheading"></p><a id="e279"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<!-- EXAMPLE START -->
<a href="RB_10_3.html#e279" class="eglink"><b>378</b></a></div>
<div class="egpanel" id="example279">
<p>Suppose we want the player to have a pizza buffet from which he can take a number of slices. But we don't want to actually put the slices there in front of him, because &quot;you can see 17 slices of pizza here&quot; is not the descriptive effect we want, and because we want to pretend, at least, that the pizza supply is nearly infinite. In fact, we're going to replenish the supply by allowing eaten slices to return to the buffet table (safer in IF than in real life).</p>
<p>To do this, we create one object to stand in for the pizza supply, but whenever the player tries to take it, we give him a different &quot;pizza slice&quot; object instead. Thus:</p>
<!-- START CODE "c32061" -->
<a id="c32061"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Pizza Prince[=0x0022=][=0x000A=][=0x000A=]The Pizza Prince is a room.[=0x000A=][=0x000A=]The buffet table is a supporter in Pizza Prince.[=0x000A=][=0x000A=]The pizza selection is a thing on the buffet table. Understand [=0x0022=]slice[=0x0022=] as the pizza selection. The description is [=0x0022=]They are all cheese-only, and all luke-warm.[=0x0022=][=0x000A=][=0x000A=]Rule for writing a paragraph about the buffet table:[=0x000A=][=0x0009=]say [=0x0022=]On [the buffet table] is [a pizza selection]. [description of the pizza selection][line break][=0x0022=].[=0x000A=][=0x000A=][Now we introduce our actual pizza slices, which are retained in a container out of play until they[=0x0027=]re needed:][=0x000A=][=0x000A=]A pizza slice is a kind of thing. 10 pizza slices are in Pizza Limbo. A pizza slice is always edible. [After a fashion, anyway.][=0x000A=][=0x000A=][In this example we[=0x0027=]ve set that supply to be artificially small, to make it easier to test what happens when the player reaches the limit; but we could provide many more slices to start with in Pizza Limbo, and the aim in practice would be to pick a number high enough (such as 50 or 100) that the average player will get bored of TAKE PIZZA long before he reaches the limit.][=0x000A=][=0x000A=][The main thing to be aware of is that objects consume memory in the game file, so creating a large number of pizza slices might bulk the game out. This is more of a concern if we[=0x0027=]re compiling for the Z-machine than if we[=0x0027=]re compiling for Glulx.][=0x000A=][=0x000A=][Whenever the player tries to take the selection, we want him to wind up holding an individual slice instead; but of course we need to check and make sure that he hasn[=0x0027=]t exhausted the pizza slice supply.][=0x000A=][=0x000A=]Instead of taking the pizza selection:[=0x000A=][=0x0009=]let chosen slice be a random pizza slice in Pizza Limbo;[=0x000A=][=0x0009=]if chosen slice is nothing: [That is, there were no slices remaining][=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][manager refusal][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]move the chosen slice to the player;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]Taken (gingerly).[=0x0022=][=0x000A=][=0x000A=]To say manager refusal:[=0x000A=][=0x0009=]say [=0x0022=][one of][=0x0027=]Hey![=0x0027=] barks a hitherto-unseen manager from behind you. [=0x0027=]It[=0x0027=]s an [=0x0027=]all you can eat[=0x0027=] buffet, not an [=0x0027=]all you can stuff down your pants[=0x0027=] buffet.[=0x0027=][or]You are conscious of a disapproving huff from the manager, so you refrain.[stopping][=0x0022=][=0x000A=][=0x000A=][That[=0x0027=]s fine for the case where the player is taking a new slice of pizza explicitly, but we need to handle it a little differently if the taking action is generated in response to EAT PIZZA. In that case, we need to take the slice and also change the identity of the noun, because after the implicit take action happens, the game will test whether the player is holding the noun before attempting to eat it. So we need to refocus its attention:][=0x000A=][=0x000A=]Rule for implicitly taking the pizza selection:[=0x000A=][=0x0009=]let chosen slice be a random pizza slice in Pizza Limbo;[=0x000A=][=0x0009=]if chosen slice is nothing: [That is, there were no slices remaining][=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][manager refusal][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]move the chosen slice to the player;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=](helping yourself from the selection)[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]now the noun is the chosen slice.[=0x000A=][=0x000A=][And finally, a bit of touch-up:][=0x000A=][=0x000A=]Rule for clarifying the parser[=0x0027=]s choice of the pizza selection while taking:[=0x000A=][=0x0009=]say [=0x0022=](from the magnificent selection before you)[line break][=0x0022=][=0x000A=][=0x000A=][For tidiness, we should probably also return the consumed pizza slices to Pizza Limbo so that they can be re-used later:][=0x000A=][=0x000A=]After eating a pizza slice:[=0x000A=][=0x0009=]move the noun to Pizza Limbo;[=0x000A=][=0x0009=]continue the action.[=0x000A=][=0x000A=]Test me with [=0x0022=]i / get pizza / g / i / get pizza / drop pizza / look / get pizza / g / look / eat pizza / g / g / g / g / get pizza / g / g / g / g / g / g / g / g / g / g / g / g / i / eat pizza / take pizza / g[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="Documentation/Images/paste.png" /></a> &quot;Pizza Prince&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32062" -->
<a id="c32062"></a><blockquote class="code"><p class="quoted">
The Pizza Prince is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32063" -->
<a id="c32063"></a><blockquote class="code"><p class="quoted">
The buffet table is a supporter in Pizza Prince.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32064" -->
<a id="c32064"></a><blockquote class="code"><p class="quoted">
The pizza selection is a thing on the buffet table. Understand &quot;slice&quot; as the pizza selection. The description is &quot;They are all cheese-only, and all luke-warm.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32065" -->
<a id="c32065"></a><blockquote class="code"><p class="quoted">
Rule for writing a paragraph about the buffet table:
<br />&#160;&#160;&#160;&#160;say &quot;On [the buffet table] is [a pizza selection]. [description of the pizza selection][line break]&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Now we introduce our actual pizza slices, which are retained in a container out of play until they're needed:</p>
<!-- START CODE "c32066" -->
<a id="c32066"></a><blockquote class="code"><p class="quoted">
A pizza slice is a kind of thing. 10 pizza slices are in Pizza Limbo. A pizza slice is always edible. [After a fashion, anyway.]
</p></blockquote>
<!-- END CODE -->
<p>In this example we've set that supply to be artificially small, to make it easier to test what happens when the player reaches the limit; but we could provide many more slices to start with in Pizza Limbo, and the aim in practice would be to pick a number high enough (such as 50 or 100) that the average player will get bored of TAKE PIZZA long before he reaches the limit.</p>
<p>The main thing to be aware of is that objects consume memory in the game file, so creating a large number of pizza slices might bulk the game out. This is more of a concern if we're compiling for the Z-machine than if we're compiling for Glulx.</p>
<p>Whenever the player tries to take the selection, we want him to wind up holding an individual slice instead; but of course we need to check and make sure that he hasn't exhausted the pizza slice supply.</p>
<!-- START CODE "c32067" -->
<a id="c32067"></a><blockquote class="code"><p class="quoted">
Instead of taking the pizza selection:
<br />&#160;&#160;&#160;&#160;let chosen slice be a random pizza slice in Pizza Limbo;
<br />&#160;&#160;&#160;&#160;if chosen slice is nothing: [That is, there were no slices remaining]
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[manager refusal]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the chosen slice to the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Taken (gingerly).&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32068" -->
<a id="c32068"></a><blockquote class="code"><p class="quoted">
To say manager refusal:
<br />&#160;&#160;&#160;&#160;say &quot;[one of]'Hey!' barks a hitherto-unseen manager from behind you. 'It's an 'all you can eat' buffet, not an 'all you can stuff down your pants' buffet.'[or]You are conscious of a disapproving huff from the manager, so you refrain.[stopping]&quot;
</p></blockquote>
<!-- END CODE -->
<p>That's fine for the case where the player is taking a new slice of pizza explicitly, but we need to handle it a little differently if the taking action is generated in response to EAT PIZZA. In that case, we need to take the slice and also change the identity of the noun, because after the implicit take action happens, the game will test whether the player is holding the noun before attempting to eat it. So we need to refocus its attention:</p>
<!-- START CODE "c32069" -->
<a id="c32069"></a><blockquote class="code"><p class="quoted">
Rule for implicitly taking the pizza selection:
<br />&#160;&#160;&#160;&#160;let chosen slice be a random pizza slice in Pizza Limbo;
<br />&#160;&#160;&#160;&#160;if chosen slice is nothing: [That is, there were no slices remaining]
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[manager refusal]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the chosen slice to the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;(helping yourself from the selection)&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the noun is the chosen slice.
</p></blockquote>
<!-- END CODE -->
<p>And finally, a bit of touch-up:</p>
<!-- START CODE "c32070" -->
<a id="c32070"></a><blockquote class="code"><p class="quoted">
Rule for clarifying the parser's choice of the pizza selection while taking:
<br />&#160;&#160;&#160;&#160;say &quot;(from the magnificent selection before you)[line break]&quot;
</p></blockquote>
<!-- END CODE -->
<p>For tidiness, we should probably also return the consumed pizza slices to Pizza Limbo so that they can be re-used later:</p>
<!-- START CODE "c32071" -->
<a id="c32071"></a><blockquote class="code"><p class="quoted">
After eating a pizza slice:
<br />&#160;&#160;&#160;&#160;move the noun to Pizza Limbo;
<br />&#160;&#160;&#160;&#160;continue the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32072" -->
<a id="c32072"></a><blockquote class="code"><p class="quoted">
Test me with &quot;i / get pizza / g / i / get pizza / drop pizza / look / get pizza / g / look / eat pizza / g / g / g / g / get pizza / g / g / g / g / g / g / g / g / g / g / g / g / i / eat pizza / take pizza / g&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<!-- EXAMPLE END -->
<!-- EXAMPLE START -->
</td><td class="egnamecell"><p class="egcuetext"><a href="RB_10_3.html#e279" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner"><b>Example</b></span><span class="egname">Pizza Prince</span></b></a><br />Providing a pizza buffet from which the player can take as many pieces as he wants.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egpanel" id="example279">
<p>Suppose we want the player to have a pizza buffet from which he can take a number of slices. But we don't want to actually put the slices there in front of him, because &quot;you can see 17 slices of pizza here&quot; is not the descriptive effect we want, and because we want to pretend, at least, that the pizza supply is nearly infinite. In fact, we're going to replenish the supply by allowing eaten slices to return to the buffet table (safer in IF than in real life).</p>
<p>To do this, we create one object to stand in for the pizza supply, but whenever the player tries to take it, we give him a different &quot;pizza slice&quot; object instead. Thus:</p>
<!-- START CODE "c32073" -->
<a id="c32073"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Pizza Prince[=0x0022=][=0x000A=][=0x000A=]The Pizza Prince is a room.[=0x000A=][=0x000A=]The buffet table is a supporter in Pizza Prince.[=0x000A=][=0x000A=]The pizza selection is a thing on the buffet table. Understand [=0x0022=]slice[=0x0022=] as the pizza selection. The description is [=0x0022=]They are all cheese-only, and all luke-warm.[=0x0022=][=0x000A=][=0x000A=]Rule for writing a paragraph about the buffet table:[=0x000A=][=0x0009=]say [=0x0022=]On [the buffet table] is [a pizza selection]. [description of the pizza selection][line break][=0x0022=].[=0x000A=][=0x000A=][Now we introduce our actual pizza slices, which are retained in a container out of play until they[=0x0027=]re needed:][=0x000A=][=0x000A=]A pizza slice is a kind of thing. 10 pizza slices are in Pizza Limbo. A pizza slice is always edible. [After a fashion, anyway.][=0x000A=][=0x000A=][In this example we[=0x0027=]ve set that supply to be artificially small, to make it easier to test what happens when the player reaches the limit; but we could provide many more slices to start with in Pizza Limbo, and the aim in practice would be to pick a number high enough (such as 50 or 100) that the average player will get bored of TAKE PIZZA long before he reaches the limit.][=0x000A=][=0x000A=][The main thing to be aware of is that objects consume memory in the game file, so creating a large number of pizza slices might bulk the game out. This is more of a concern if we[=0x0027=]re compiling for the Z-machine than if we[=0x0027=]re compiling for Glulx.][=0x000A=][=0x000A=][Whenever the player tries to take the selection, we want him to wind up holding an individual slice instead; but of course we need to check and make sure that he hasn[=0x0027=]t exhausted the pizza slice supply.][=0x000A=][=0x000A=]Instead of taking the pizza selection:[=0x000A=][=0x0009=]let chosen slice be a random pizza slice in Pizza Limbo;[=0x000A=][=0x0009=]if chosen slice is nothing: [That is, there were no slices remaining][=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][manager refusal][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]move the chosen slice to the player;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]Taken (gingerly).[=0x0022=][=0x000A=][=0x000A=]To say manager refusal:[=0x000A=][=0x0009=]say [=0x0022=][one of][=0x0027=]Hey![=0x0027=] barks a hitherto-unseen manager from behind you. [=0x0027=]It[=0x0027=]s an [=0x0027=]all you can eat[=0x0027=] buffet, not an [=0x0027=]all you can stuff down your pants[=0x0027=] buffet.[=0x0027=][or]You are conscious of a disapproving huff from the manager, so you refrain.[stopping][=0x0022=][=0x000A=][=0x000A=][That[=0x0027=]s fine for the case where the player is taking a new slice of pizza explicitly, but we need to handle it a little differently if the taking action is generated in response to EAT PIZZA. In that case, we need to take the slice and also change the identity of the noun, because after the implicit take action happens, the game will test whether the player is holding the noun before attempting to eat it. So we need to refocus its attention:][=0x000A=][=0x000A=]Rule for implicitly taking the pizza selection:[=0x000A=][=0x0009=]let chosen slice be a random pizza slice in Pizza Limbo;[=0x000A=][=0x0009=]if chosen slice is nothing: [That is, there were no slices remaining][=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][manager refusal][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]move the chosen slice to the player;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=](helping yourself from the selection)[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]now the noun is the chosen slice.[=0x000A=][=0x000A=][And finally, a bit of touch-up:][=0x000A=][=0x000A=]Rule for clarifying the parser[=0x0027=]s choice of the pizza selection while taking:[=0x000A=][=0x0009=]say [=0x0022=](from the magnificent selection before you)[line break][=0x0022=][=0x000A=][=0x000A=][For tidiness, we should probably also return the consumed pizza slices to Pizza Limbo so that they can be re-used later:][=0x000A=][=0x000A=]After eating a pizza slice:[=0x000A=][=0x0009=]move the noun to Pizza Limbo;[=0x000A=][=0x0009=]continue the action.[=0x000A=][=0x000A=]Test me with [=0x0022=]i / get pizza / g / i / get pizza / drop pizza / look / get pizza / g / look / eat pizza / g / g / g / g / get pizza / g / g / g / g / g / g / g / g / g / g / g / g / i / eat pizza / take pizza / g[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="Documentation/Images/paste.png" /></a> &quot;Pizza Prince&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32074" -->
<a id="c32074"></a><blockquote class="code"><p class="quoted">
The Pizza Prince is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32075" -->
<a id="c32075"></a><blockquote class="code"><p class="quoted">
The buffet table is a supporter in Pizza Prince.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32076" -->
<a id="c32076"></a><blockquote class="code"><p class="quoted">
The pizza selection is a thing on the buffet table. Understand &quot;slice&quot; as the pizza selection. The description is &quot;They are all cheese-only, and all luke-warm.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32077" -->
<a id="c32077"></a><blockquote class="code"><p class="quoted">
Rule for writing a paragraph about the buffet table:
<br />&#160;&#160;&#160;&#160;say &quot;On [the buffet table] is [a pizza selection]. [description of the pizza selection][line break]&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Now we introduce our actual pizza slices, which are retained in a container out of play until they're needed:</p>
<!-- START CODE "c32078" -->
<a id="c32078"></a><blockquote class="code"><p class="quoted">
A pizza slice is a kind of thing. 10 pizza slices are in Pizza Limbo. A pizza slice is always edible. [After a fashion, anyway.]
</p></blockquote>
<!-- END CODE -->
<p>In this example we've set that supply to be artificially small, to make it easier to test what happens when the player reaches the limit; but we could provide many more slices to start with in Pizza Limbo, and the aim in practice would be to pick a number high enough (such as 50 or 100) that the average player will get bored of TAKE PIZZA long before he reaches the limit.</p>
<p>The main thing to be aware of is that objects consume memory in the game file, so creating a large number of pizza slices might bulk the game out. This is more of a concern if we're compiling for the Z-machine than if we're compiling for Glulx.</p>
<p>Whenever the player tries to take the selection, we want him to wind up holding an individual slice instead; but of course we need to check and make sure that he hasn't exhausted the pizza slice supply.</p>
<!-- START CODE "c32079" -->
<a id="c32079"></a><blockquote class="code"><p class="quoted">
Instead of taking the pizza selection:
<br />&#160;&#160;&#160;&#160;let chosen slice be a random pizza slice in Pizza Limbo;
<br />&#160;&#160;&#160;&#160;if chosen slice is nothing: [That is, there were no slices remaining]
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[manager refusal]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the chosen slice to the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Taken (gingerly).&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32080" -->
<a id="c32080"></a><blockquote class="code"><p class="quoted">
To say manager refusal:
<br />&#160;&#160;&#160;&#160;say &quot;[one of]'Hey!' barks a hitherto-unseen manager from behind you. 'It's an 'all you can eat' buffet, not an 'all you can stuff down your pants' buffet.'[or]You are conscious of a disapproving huff from the manager, so you refrain.[stopping]&quot;
</p></blockquote>
<!-- END CODE -->
<p>That's fine for the case where the player is taking a new slice of pizza explicitly, but we need to handle it a little differently if the taking action is generated in response to EAT PIZZA. In that case, we need to take the slice and also change the identity of the noun, because after the implicit take action happens, the game will test whether the player is holding the noun before attempting to eat it. So we need to refocus its attention:</p>
<!-- START CODE "c32081" -->
<a id="c32081"></a><blockquote class="code"><p class="quoted">
Rule for implicitly taking the pizza selection:
<br />&#160;&#160;&#160;&#160;let chosen slice be a random pizza slice in Pizza Limbo;
<br />&#160;&#160;&#160;&#160;if chosen slice is nothing: [That is, there were no slices remaining]
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[manager refusal]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the chosen slice to the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;(helping yourself from the selection)&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the noun is the chosen slice.
</p></blockquote>
<!-- END CODE -->
<p>And finally, a bit of touch-up:</p>
<!-- START CODE "c32082" -->
<a id="c32082"></a><blockquote class="code"><p class="quoted">
Rule for clarifying the parser's choice of the pizza selection while taking:
<br />&#160;&#160;&#160;&#160;say &quot;(from the magnificent selection before you)[line break]&quot;
</p></blockquote>
<!-- END CODE -->
<p>For tidiness, we should probably also return the consumed pizza slices to Pizza Limbo so that they can be re-used later:</p>
<!-- START CODE "c32083" -->
<a id="c32083"></a><blockquote class="code"><p class="quoted">
After eating a pizza slice:
<br />&#160;&#160;&#160;&#160;move the noun to Pizza Limbo;
<br />&#160;&#160;&#160;&#160;continue the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c32084" -->
<a id="c32084"></a><blockquote class="code"><p class="quoted">
Test me with &quot;i / get pizza / g / i / get pizza / drop pizza / look / get pizza / g / look / eat pizza / g / g / g / g / get pizza / g / g / g / g / g / g / g / g / g / g / g / g / i / eat pizza / take pizza / g&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<!-- EXAMPLE END -->
<div class="egovalforxref overstruckimage">
<a  href="ex279.html#e279"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<a id="e228"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="Rex228.html#e228" class="eglink"><b>124</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="Rex228.html#e228" class="eglink"><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><img class="asterisk" alt="*" src="Documentation/Images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Extra Supplies</span></b></a><br />A supply of red pens from which the player can take another pen only if he doesn't already have one somewhere in the game world.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="ex228.html#e228"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
</body>
</html>
